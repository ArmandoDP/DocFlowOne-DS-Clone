---
import type { Section } from "@/types";
import type { z } from "astro:content";
import { markdownify } from "@/lib/utils/textConverter";
import { getEntryCTM } from "@/lib/customContentLoader.astro";
import overrideObjects from "@/lib/utils/overrideObjects.ts";
import type { BenefitsSectionSchema } from "@/sections.schema";
import OptimizedImage from "../utilities/OptimizedImage.astro";
import Carousel from "../cards/Carousel.astro";
import { logos } from "../../../../data/logos";

export type BenefitsSection = Section & z.infer<typeof BenefitsSectionSchema>;

type Props = {
  content?: BenefitsSection;
};

let defaultContent = (
  await getEntryCTM("sections", "benefits", Astro.currentLocale)
)?.data as BenefitsSection;

let actualContent = overrideObjects(
  { ...defaultContent },
  Astro.props.content,
) as BenefitsSection;

let { enable = true, title, benefits, description } = actualContent;

// const isDarkAppearance = appearance === "dark";

if (!enable) {
  return null;
}

// console.log("Slug usado:", slug);
// console.log("Archivo cargado:", defaultContent);

// console.log("⚠️ Astro.currentLocale:", Astro.currentLocale);
// console.log("⚠️ defaultContent:", defaultContent);
// console.log("⚠️ actualContent:", actualContent);
// console.log("⚠️ benefits:", benefits);

if (!enable) return null;
---

<section class="bg-white py-4 text-black">
  <div class="container">
    {
      title && (
        <h2
          class="text-center text-lg font-medium md:text-4xl"
          data-aos="reveal-anim-top"
          data-aos-duration="2000"
          set:html={markdownify(title)}
        />
      )
    }

    {
      description && (
        <p
          class="mx-auto mb-6 max-w-3xl text-center text-lg opacity-80"
          set:html={markdownify(description)}
        />
      )
    }

    <div class="mx-auto max-w-6xl divide-y-4 divide-[#C20E30]">
      <!-- Fila 1 -->
      <div
        class="mt-8 grid grid-cols-1 gap-4 border-t-4 border-[#C20E30] py-8 sm:grid-cols-2 md:grid-cols-3">
        {
          benefits?.slice(0, 3).map((b) => (
            <div
              class="flex flex-col items-start px-12 text-left md:items-start md:px-4 md:text-left"
              data-aos="reveal-anim-top"
              data-aos-duration="2000">
              <img
                src={b.icon}
                alt={b.title}
                class="mb-4 h-14 w-14 object-contain"
              />
              <h3 class="mb-2 text-lg font-medium">{b.title}</h3>
              <p class="text-justify text-sm leading-relaxed text-gray-800">
                {b.description}
              </p>
            </div>
          ))
        }
      </div>

      <!-- Fila 2 -->
      <div class="grid grid-cols-1 gap-10 py-10 sm:grid-cols-2 md:grid-cols-3">
        {
          benefits?.slice(3, 6).map((b) => (
            <div
              class="flex flex-col items-start px-12 text-left md:items-start md:px-4 md:text-left"
              data-aos="reveal-anim-top"
              data-aos-duration="2000">
              <img
                src={b.icon}
                alt={b.title}
                class="mb-4 h-14 w-14 object-contain"
              />
              <h3 class="mb-2 text-lg font-medium">{b.title}</h3>
              <p class="text-justify text-sm leading-relaxed text-gray-800">
                {b.description}
              </p>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>
