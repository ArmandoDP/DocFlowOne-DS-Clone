---
import { markdownify } from "@/lib/utils/textConverter";
import { getEntryCTM } from "@/lib/customContentLoader.astro";
import type { footerSectionSchema } from "@/sections.schema";
import type { z } from "astro:content";
import OptimizedImage from "@/components/utilities/OptimizedImage.astro";

type FooterSection = z.infer<typeof footerSectionSchema>;

let { data: content } =
  (await getEntryCTM("sections", "footer", Astro.currentLocale)) ?? {};

const {
  enable = true,
  top,
  columns,
  social = [],
  bottom,
} = (content || {}) as FooterSection;

if (!enable) return null;
---

<!-- TOP SECTION (franja negra testimonial) -->
<section class="bg-[#0F1017] py-16 text-center text-white">
  <h2 class="mb-4 text-3xl font-bold md:text-4xl">
    {top.title}
  </h2>

  <p class="mx-auto mb-8 max-w-3xl text-lg opacity-90">
    {top.description}
  </p>

  <a
    href="#"
    class="inline-block rounded-lg bg-[#4D5262] px-10 py-3 text-white transition hover:bg-[#5A5F70]">
    {top.buttonLabel}
  </a>
</section>

<!-- FOOTER INFERIOR -->
<footer class="bg-[#F5F6F8] py-14 text-[#15151b]">
  <div class="container mx-auto px-6">
    <!-- LOGO + COLUMNS -->
    <div class="mb-12 grid grid-cols-1 gap-10 md:grid-cols-4">
      <!-- LOGO -->
      <div>
        <OptimizedImage
          src="/src/assets/images/logo.png"
          alt="DocSolutions"
          class="mb-6 w-[180px]"
        />

        <!-- social icons -->
        <div class="mt-4 flex gap-4">
          {
            social.map((s) => (
              <a
                href={s.url}
                target="_blank"
                class="flex h-10 w-10 items-center justify-center rounded-md bg-[#11131A] transition hover:opacity-75">
                <i class={`bi bi-${s.icon} text-xl text-white`} />
              </a>
            ))
          }
        </div>
      </div>

      <!-- COLUMNS -->
      {
        columns.map((column) => (
          <div>
            <h4 class="mb-4 text-lg font-semibold">{column.title}</h4>

            <ul class="space-y-3">
              {column.links.map((l) => (
                <li>
                  <a
                    href={l.url}
                    class="text-sm text-[#15151b] transition hover:text-[#C20E30]">
                    {l.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        ))
      }
    </div>

    <!-- BOTTOM LINE -->
    <div
      class="flex flex-col items-center justify-between border-t pt-6 text-sm md:flex-row">
      <p>{bottom.copyright}</p>

      <div class="mt-4 flex gap-8 md:mt-0">
        <a href={bottom.privacyUrl} class="hover:text-[#C20E30]">
          {bottom.privacy}
        </a>
        <a href={bottom.termsUrl} class="hover:text-[#C20E30]">
          {bottom.terms}
        </a>
      </div>
    </div>
  </div>
</footer>
